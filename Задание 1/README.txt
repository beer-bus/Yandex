ЗАДАНИЕ:

Имеется файл с временной статистикой работы асессоров над однотипным заданием.
Формат файла: login tid Microtasks assigned_ts tclosed_ts.
Пояснение к формату: login — логин асессора; tid — id оцениваемого задания (task id); Microtasks – количество микрозаданий в одном задании; assigned_ts — время резервирования системой задания для асессора; closed_ts — точное время завершения работы над заданием; разделитель — табуляция \t.
Задание может состоять из одного или несколько микрозаданий. Время резервирования задания (assigned_ts) указывает на тот момент, когда система назначила определенного асессора исполнителем этого задания. Этот момент может совпадать с временем начала работы асессора над заданием, а может и не совпадать (асессор может отойти выпить чаю, а потом приступить к заданию, асессор может выполнять предыдущее задание, в то время как за ним зарезервированы новые).
Предположим, что асессор за 30 секунд своего рабочего времени получает N рублей.
Какую оплату вы считаете справедливой для выполнения асессором одного микрозадания из этого файла? Опишите подробно все этапы вашего решения.

РЕШЕНИЕ:

1. Проведем первичную оценку и подготовку данных.
Таблица состоит из 701827 строк, пропущенные значения отсутствуют.
Изменим формат данных в столбцах с датами (assigned_ts и closed_ts) из str в datatime. Предположим, что все задания выполнены верно.

2. Создадим новый столбец - время выполнения задачи (разность столбцов closed_ts и assigned_ts).

3. Добавим столбец со средним временем выполнения микрозаданий: поделим время выполнения задачи на число микрозаданий и переведем значения в секунды.

4. Проверим качество данных:
Сгруппируем время выполнения по задачам (task id) и посчитаем среднее время выполнения микрозадачи среди пользователей.
Получим столбец в котором строки соответствуют среднему времени выполнения микрозадач для каждой уникальной задачи из task id.
Для данного столбца сравним среднее и медианное значения времени выполнения микрозадач.
По итогам проверки обнаружено, что результаты различаются.

5. Исключим из выборки асессоров, у которых среднее время выполнения микрозадач больше, чем медианное значение времени выполнения микрозадачизадачи взятое для всех асессоров.

6. Оценим медиану времени выполнения микрозадачи взятую для средних значений сгруппированных по ID задач.

7. Округлив значение, полученное в пункте 6 и добавив 50% (исходя из рекомендаций Толоки) сделаем вывод, что справедливой оплатой выполнения одного микрозадания будет составлять 3N.